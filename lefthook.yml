colors: true

pre-commit:
  parallel: true
  commands:
    lint:
      glob: '*.{js,jsx,ts,tsx}'
      run: |
        echo "ðŸ” Linting code..."
        pnpm run lint
      skip: [merge, rebase]

    typecheck:
      glob: '*.{ts,tsx}'
      run: |
        echo "ðŸ”Ž Type checking..."
        pnpm run check-types
      skip: [merge, rebase]

    test:
      glob: '*.{ts,tsx}'
      run: |
        echo "ðŸ§ª Running unit tests..."
        pnpm run test:unit
      skip: [merge, rebase]

commit-msg:
  commands:
    commitlint:
      run: |
        echo "ðŸ“ Validating commit message..."
        bunx commitlint --edit "$1"

post-merge:
  commands:
    update-deps:
      run: |
        echo "ðŸ“¦ Checking dependencies..."
        if git diff --name-only ORIG_HEAD HEAD 2>/dev/null | grep -E 'pnpm-lock\.yaml|package\.json'; then
          echo "ðŸ“¦ Updating dependencies..."
          pnpm install
        fi

post-checkout:
  commands:
    setup:
      run: |
        echo "ðŸ§¹ Preparing workspace..."
        if [ "$3" = "1" ] && git diff --name-only $1 $2 2>/dev/null | grep -E 'pnpm-lock\.yaml|package\.json'; then
          echo "ðŸ“¦ Updating dependencies for new branch..."
          pnpm install
        fi
